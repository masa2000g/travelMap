# travelMap 実装履歴メモ

時系列で主要な UI/機能改修をざっくり記録したメモです。追加作業のたびに追記して開発の経緯を把握できるようにします。

## 2024-??（現行開発）

- **DQ 風 UI への刷新**  
  - メニューを `> 表示設定 / > 出費関係 / > 神のお告げ / > 王の出資` の 2×2 レイアウトに変更。  
  - ステータスウィンドウを RPG 表記（Lv/Cal/Slp/G/縛り）にし、タイトルや項目の整列を調整。
- **出費関係ウィンドウのタブ化**  
  - `統計` タブ内に「集計閲覧」「出費日足」「カテゴリグラフ」のサブタブを設置。  
  - `予算` タブは月次切り替え UI（今月を基準に前後月移動）とカテゴリ別の予算/使用額/使用率表示を実装。
- **表示設定のシンプル化**  
  - 期間プリセットのみで即時反映する仕様に整理。カテゴリ凡例の ON/OFF トグルを追加。  
  - マップの期間内軌跡は青→緑→黄→オレンジのグラデーション、期間外軌跡は半透明で残す構成。
- **地図演出**  
  - 期間内軌跡は最新が鮮やかなオレンジ、最古が淡いブルーになる彩度・明度グラデーション。  
  - 最新位置マーカーを `generated-icon.png`（差し替え済み）に統一。
- **出費分析機能の強化**  
  - 「集計閲覧」で総額/日平均/件平均/最大支出を表示。  
  - 「出費日足」で期間中の日別支出を折れ線グラフ化。  
  - 「カテゴリグラフ」でカテゴリ別合計＋ツールチップに件数を表示。
- **予算タブ独立**  
  - メニュー階層では「出費関係」内で `統計` / `予算` を切替。表示設定とは独立した期間管理。  
  - Firestore `meta/budgets` 連携でカテゴリごとの予算残高を算出。
- **ウィンドウ操作性の改善**  
  - すべての子ウィンドウをドラッグで移動可能にし、モバイルタッチ対応の pointer ベース実装へ。  
  - メニュー/ステータスより前面に子ウィンドウを表示するよう z-index を調整。

## TODO / 検討中

- iPhone Safari で表示設定・統計プリセットのグリッドが縦並びになる件の完全解消。  
- ステータス/メニュー周りのレスポンシブ最適化（特に縦長画面）。  
- ドキュメント（仕様・引き継ぎ）の継続更新。

> ※ 日付はざっくり。必要に応じてコミットやチケット番号を追記してください。
